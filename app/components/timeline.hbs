<article class="timeline">
	<NodeEditor @node={{@timeline}}>
		<h4>
			<LinkTo @route="stories.story.timeline" @model={{@timeline}} title="Expand for more">
				{{#if @timeline.title}}
					{{@timeline.title}}
				{{else}}
					Timeline {{@index}}
				{{/if}}
			</LinkTo>
		</h4>
		<ul class="actions">
			<li class="action">
				<button type="button" {{on "click" this.addNestedTimeline}}>Add nested timeline {{svg-jar "call_split" class="rotate-90"}}</button>
			</li>
			<li class="action">
				<button type="button" {{on "click" this.addEvent}}>Add event {{svg-jar "calendar_today"}}</button>
			</li>
			<li class="action contextual-action">
				<button type="button" {{on "click" this.remove}} title="Remove timeline">{{svg-jar "delete"}}</button>
			</li>
		</ul>
	</NodeEditor>

	<ul class="events">
		{{#each this.sortedEvents as |event|}}
			<li class="event node" data-test-id={{event.id}}>
				<NodeEditor @node={{event}}>
					<ul class="actions">
						<li class="action contextual-action">
							<button type="button" {{on "click" (fn this.removeEvent event)}} title="Remove Event">{{svg-jar "delete"}}</button>
						</li>
						<li class="action add-after">
							<button type="button" {{on "click" (fn this.addEvent event)}} title="Add event after this one">{{svg-jar "add"}}</button>
						</li>
					</ul>
				</NodeEditor>
			</li>
		{{/each}}
	</ul>
	{{#each @timeline.timelines as |nestedTimeline index|}}
		<ul class="nested-timelines">
			<li class="nested-timeline">
				<Timeline @timeline={{nestedTimeline}} @index={{index}}/>
			</li>
		</ul>
	{{/each}}

	{{yield}}
</article>